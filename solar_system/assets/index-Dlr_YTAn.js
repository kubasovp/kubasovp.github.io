(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const c of i)if(c.type==="childList")for(const a of c.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function s(i){const c={};return i.integrity&&(c.integrity=i.integrity),i.referrerPolicy&&(c.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?c.credentials="include":i.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function r(i){if(i.ep)return;i.ep=!0;const c=s(i);fetch(i.href,c)}})();const n={fitMode:"cover",showLabels:!1,scale:1,planetScale:2e3,cx:0,cy:0,YEAR_MS:2e3,lastTime:performance.now()};let t,d;function w(e){d=e,t=e.getContext("2d")}const u=[{name:"Mercury",dist:58,diameter:4879,period:.24,color:"gray",eccentricity:.205},{name:"Venus",dist:108,diameter:12104,period:.62,color:"khaki",eccentricity:.007},{name:"Earth",dist:150,diameter:12742,period:1,color:"deepskyblue",eccentricity:.017},{name:"Mars",dist:228,diameter:6792,period:1.88,color:"tomato",eccentricity:.093},{name:"Jupiter",dist:778,diameter:139820,period:11.86,color:"orange",eccentricity:.049},{name:"Saturn",dist:1430,diameter:116460,period:29.46,color:"gold",eccentricity:.056},{name:"Uranus",dist:2870,diameter:50724,period:84,color:"lightblue",eccentricity:.046},{name:"Neptune",dist:4500,diameter:49244,period:165,color:"blue",eccentricity:.01}].map(e=>({...e,M:Math.random()*2*Math.PI}));function f(e,o){e.width=window.innerWidth,e.height=window.innerHeight,n.cx=e.width/2,n.cy=e.height/2;const s=Math.max(...u.map(i=>i.dist)),r=n.fitMode==="cover"?Math.max(e.width,e.height):Math.min(e.width,e.height);n.scale=(r-32)/2/s,n.planetScale=e.width<768?4800:2e3,o.style.display=e.width===e.height?"none":"inline-flex"}function b({speedSlider:e,speedLabel:o,fitRadios:s,modeLabel:r,labelsToggle:i,canvas:c}){e.addEventListener("input",()=>{n.YEAR_MS=+e.value,o.textContent=`1 год = ${(n.YEAR_MS/1e3).toFixed(1)} сек`}),s.forEach(a=>{a.addEventListener("change",l=>{n.fitMode=l.target.value,f(c,r)})}),i.addEventListener("change",a=>{n.showLabels=a.target.checked}),window.addEventListener("resize",()=>f(c,r))}function x(e,o,s=5){let r=e;for(let i=0;i<s;i++)r=r-(r-o*Math.sin(r)-e)/(1-o*Math.cos(r));return r}function S(e){for(let o of u){const s=2*Math.PI/o.period,r=e/n.YEAR_MS;o.meanAnomaly=(o.meanAnomaly||Math.random()*2*Math.PI)+s*r}}function P(){for(let e of u){const o=e.dist*n.scale,s=e.eccentricity||0,r=o*Math.sqrt(1-s**2),i=o*s,c=n.cx-i,a=n.cy,l=x(e.meanAnomaly,s),y=c+o*Math.cos(l),p=a+r*Math.sin(l),m=Math.max(1,e.diameter/n.planetScale/2);t.beginPath(),t.arc(y,p,m,0,2*Math.PI),t.fillStyle=e.color,t.fill(),n.showLabels&&(t.fillStyle="white",t.fillText(e.name,y+m,p-m))}}function E(){t.clearRect(0,0,d.width,d.height),t.beginPath(),t.arc(n.cx,n.cy,3,0,2*Math.PI),t.fillStyle="yellow",t.fill(),t.beginPath(),t.moveTo(n.cx,n.cy),t.lineTo(d.width,n.cy),t.strokeStyle="rgba(255,255,255,0.5)",t.setLineDash([4,4]),t.stroke(),t.setLineDash([])}function L(){t.font="10px sans-serif",t.fillStyle="white",t.textAlign="left",t.textBaseline="top";for(let e of u){const o=e.dist*n.scale,s=e.eccentricity||0,r=o*Math.sqrt(1-s**2),i=o*s,c=n.cx-i,a=n.cy;t.beginPath(),t.ellipse(c,a,o,r,0,0,2*Math.PI),t.strokeStyle="rgba(255,255,255,0.2)",t.stroke(),["Mars","Jupiter","Saturn","Uranus","Neptune"].includes(e.name)&&t.fillText(`${e.dist} млн км`,c+o-4,a+4)}}function g(e){const o=e-n.lastTime;n.lastTime=e,S(o),E(),L(),P(),requestAnimationFrame(g)}const h=document.getElementById("solar"),A=document.querySelector(".controls__slider"),q=document.querySelector(".controls__value"),I=document.querySelectorAll("input[name='fitMode']"),M=document.querySelector(".fit-label"),T=document.getElementById("labelsToggle");w(h);f(h,M);b({speedSlider:A,speedLabel:q,fitRadios:I,modeLabel:M,labelsToggle:T,canvas:h});requestAnimationFrame(g);
